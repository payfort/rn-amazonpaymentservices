{"version":3,"names":["_react","_interopRequireWildcard","require","React","_reactNative","_RnAmazonPaymentServiceSdk","_interopRequireDefault","_nativeResponseSelector","_payButtonSelector","_styleDefaults","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_extends","assign","bind","arguments","length","apply","ViewManager","requireNativeComponent","DirectPayManager","props","onFailure","onSuccess","requestObject","environment","DEFAULT_STYLE","width","DIRECT_PAY_VIEW_WIDTH","height","DIRECT_PAY_VIEW_HEIGHT","defaultStyle","style","propsDone","isIOS","Platform","OS","createFragment","viewId","UIManager","dispatchViewManagerCommand","DirectPay","Commands","create","toString","returnSuccessParsed","response","responseObject","nativeResponseSelector","returnFailureParsed","ref","useRef","payButtonProps","payButtonSelector","setUpScreen","findNodeHandle","current","RnAmazonPaymentServiceSdk","callDirectPayFortRequest","styleAndroid","PixelRatio","getPixelSizeForLayoutSize","propsAdjustedAndroid","propsAdjustedIOS","useEffect","setTimeout","createElement","ScrollView","scrollEnabled","showsVerticalScrollIndicator","Text","_default","exports"],"sources":["DirectPayManager.tsx"],"sourcesContent":["import * as React from 'react';\nimport {\n  findNodeHandle,\n  PixelRatio,\n  Platform,\n  requireNativeComponent,\n  ScrollView,\n  UIManager,\n  Text,\n} from 'react-native';\nimport { useEffect, useRef } from 'react';\nimport RnAmazonPaymentServiceSdk from '../nativeModules/RnAmazonPaymentServiceSdk';\nimport nativeResponseSelector from '../utils/nativeResponseSelector';\nimport type { customCheckoutViewProps } from '../types/viewProps';\nimport payButtonSelector from '../utils/payButtonSelector';\nimport {\n  DIRECT_PAY_VIEW_HEIGHT,\n  DIRECT_PAY_VIEW_WIDTH,\n} from '../constants/styleDefaults';\n\nconst ViewManager = requireNativeComponent('DirectPay');\n\nconst DirectPayManager: React.FC<customCheckoutViewProps> = (props) => {\n  const {\n    onFailure = () => {},\n    onSuccess = () => {},\n    requestObject,\n    environment = 'TEST',\n  } = props;\n\n  const DEFAULT_STYLE = {\n    width: DIRECT_PAY_VIEW_WIDTH,\n    height: DIRECT_PAY_VIEW_HEIGHT,\n  };\n  const defaultStyle = props.style ? props.style : DEFAULT_STYLE;\n  const propsDone = requestObject;\n  const isIOS = Platform.OS === 'ios';\n\n  const createFragment = (viewId: any) =>\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // we are calling the 'create' command\n      // @ts-ignore\n      UIManager.DirectPay.Commands.create.toString(),\n      [viewId]\n    );\n\n  const returnSuccessParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onSuccess) {\n      onSuccess(responseObject);\n    }\n  };\n\n  const returnFailureParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onFailure) {\n      onFailure(responseObject);\n    }\n  };\n\n  const ref = useRef(null);\n\n  const payButtonProps = payButtonSelector(props.payButtonProps);\n\n  const setUpScreen = () => {\n    const viewId = findNodeHandle(ref.current);\n    createFragment(viewId);\n    RnAmazonPaymentServiceSdk.callDirectPayFortRequest(\n      requestObject,\n      payButtonProps,\n      environment,\n      returnSuccessParsed,\n      returnFailureParsed\n    );\n  };\n\n  const styleAndroid = {\n    style: {\n      // @ts-ignore\n      height: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.height),\n      // @ts-ignore\n      width: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.width),\n    },\n  };\n\n  const propsAdjustedAndroid = {\n    ...props,\n    ...styleAndroid,\n  };\n\n  const propsAdjustedIOS = {\n    ...props,\n    payButtonProps,\n    onSuccess: returnSuccessParsed,\n    onFailure: returnFailureParsed,\n  };\n\n  useEffect(() => {\n    !isIOS && propsDone && setTimeout(() => setUpScreen(), 200);\n  }, [propsDone]);\n\n  return (\n    // @ts-ignore\n    <ScrollView\n      style={defaultStyle}\n      scrollEnabled={false}\n      showsVerticalScrollIndicator={false}\n    >\n      {propsDone ? (\n        <ViewManager\n          {...(isIOS ? propsAdjustedIOS : propsAdjustedAndroid)}\n          ref={ref}\n        />\n      ) : (\n        // @ts-ignore\n        <Text>Request object missing</Text>\n      )}\n    </ScrollView>\n  );\n};\n\nexport default DirectPayManager;\n"],"mappings":"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","ignoreList":[]}