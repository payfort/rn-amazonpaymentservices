{"version":3,"names":["_react","_interopRequireWildcard","require","React","_reactNative","_RnAmazonPaymentServiceSdk","_interopRequireDefault","_nativeResponseSelector","_payButtonSelector","_styleDefaults","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_extends","assign","bind","arguments","length","apply","ViewManager","requireNativeComponent","isIOS","Platform","OS","CustomCheckoutViewManager","props","onFailure","onSuccess","requestObject","environment","DEFAULT_STYLE","width","CUSTOM_UI_VIEW_WIDTH","height","CUSTOM_UI_VIEW_HEIGHT","defaultStyle","style","propsDone","returnSuccessParsed","response","responseObject","nativeResponseSelector","returnFailureParsed","createFragment","viewId","UIManager","dispatchViewManagerCommand","CustomCheckout","Commands","create","toString","ref","useRef","payButtonProps","payButtonSelector","setUpScreen","findNodeHandle","current","RnAmazonPaymentServiceSdk","callCustomFortRequest","styleAndroid","PixelRatio","getPixelSizeForLayoutSize","propsAdjustedAndroid","propsAdjustedIOS","useEffect","setTimeout","createElement","ScrollView","scrollEnabled","showsVerticalScrollIndicator","Text","_default","exports"],"sources":["CustomCheckoutViewManager.tsx"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport * as React from 'react';\nimport {\n  findNodeHandle,\n  PixelRatio,\n  Platform,\n  requireNativeComponent,\n  Text,\n  ScrollView,\n  UIManager,\n  ViewStyle,\n} from 'react-native';\nimport { useEffect, useRef } from 'react';\nimport RnAmazonPaymentServiceSdk from '../nativeModules/RnAmazonPaymentServiceSdk';\nimport nativeResponseSelector from '../utils/nativeResponseSelector';\nimport type { customCheckoutViewProps } from '../types/viewProps';\nimport payButtonSelector from '../utils/payButtonSelector';\nimport {\n  CUSTOM_UI_VIEW_HEIGHT,\n  CUSTOM_UI_VIEW_WIDTH,\n} from '../constants/styleDefaults';\n\nconst ViewManager = requireNativeComponent('CustomCheckout');\n\nconst isIOS = Platform.OS === 'ios';\n\nconst CustomCheckoutViewManager: React.FC<customCheckoutViewProps> = (\n  props\n) => {\n  const {\n    onFailure = () => {},\n    onSuccess = () => {},\n    requestObject,\n    environment = 'TEST',\n  } = props;\n\n  const DEFAULT_STYLE = {\n    width: CUSTOM_UI_VIEW_WIDTH,\n    height: CUSTOM_UI_VIEW_HEIGHT,\n  };\n  const defaultStyle: ViewStyle = props.style ? props.style : DEFAULT_STYLE;\n  const propsDone = requestObject;\n\n  const returnSuccessParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onSuccess) {\n      onSuccess(responseObject);\n    }\n  };\n\n  const returnFailureParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onFailure) {\n      onFailure(responseObject);\n    }\n  };\n\n  const createFragment = (viewId: any) =>\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // we are calling the 'create' command\n      // @ts-ignore\n      UIManager.CustomCheckout.Commands.create.toString(),\n      [viewId]\n    );\n  const ref = useRef(null);\n\n  const payButtonProps = payButtonSelector(props.payButtonProps);\n\n  const setUpScreen = () => {\n    const viewId = findNodeHandle(ref.current);\n    createFragment(viewId);\n    !isIOS &&\n      RnAmazonPaymentServiceSdk.callCustomFortRequest(\n        requestObject,\n        payButtonProps,\n        environment,\n        returnSuccessParsed,\n        returnFailureParsed\n      );\n  };\n\n\n  const styleAndroid = {\n    style: {\n      // @ts-ignore\n      height: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.height),\n      // @ts-ignore\n      width: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.width),\n    },\n  };\n\n  const propsAdjustedAndroid = {\n    ...props,\n    ...styleAndroid,\n  };\n\n  const propsAdjustedIOS = {\n    ...props,\n    payButtonProps,\n    onSuccess: returnSuccessParsed,\n    onFailure: returnFailureParsed,\n  };\n\n  useEffect(() => {\n    !isIOS && propsDone && setTimeout(() => setUpScreen(), 200);\n  }, []);\n\n  return (\n    // @ts-ignore\n    <ScrollView\n      style={defaultStyle}\n      scrollEnabled={false}\n      showsVerticalScrollIndicator={false}\n    >\n      {propsDone ? (\n        <ViewManager\n          {...(isIOS ? propsAdjustedIOS : propsAdjustedAndroid)}\n          ref={ref}\n        />\n      ) : (\n        // @ts-ignore\n        <Text>Request object missing</Text>\n      )}\n    </ScrollView>\n  );\n};\n\nexport default CustomCheckoutViewManager;\n"],"mappings":";;;;;;AACA,IAAAA,MAAA,GAAAC,uBAAA,CAAAC,OAAA;AAA+B,IAAAC,KAAA,GAAAH,MAAA;AAC/B,IAAAI,YAAA,GAAAF,OAAA;AAWA,IAAAG,0BAAA,GAAAC,sBAAA,CAAAJ,OAAA;AACA,IAAAK,uBAAA,GAAAD,sBAAA,CAAAJ,OAAA;AAEA,IAAAM,kBAAA,GAAAF,sBAAA,CAAAJ,OAAA;AACA,IAAAO,cAAA,GAAAP,OAAA;AAGoC,SAAAI,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,SAAAG,yBAAAH,CAAA,6BAAAI,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAD,wBAAA,YAAAA,CAAAH,CAAA,WAAAA,CAAA,GAAAM,CAAA,GAAAD,CAAA,KAAAL,CAAA;AAAA,SAAAT,wBAAAS,CAAA,EAAAK,CAAA,SAAAA,CAAA,IAAAL,CAAA,IAAAA,CAAA,CAAAC,UAAA,SAAAD,CAAA,eAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,WAAAE,OAAA,EAAAF,CAAA,QAAAM,CAAA,GAAAH,wBAAA,CAAAE,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAC,GAAA,CAAAP,CAAA,UAAAM,CAAA,CAAAE,GAAA,CAAAR,CAAA,OAAAS,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAf,CAAA,oBAAAe,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAjB,CAAA,EAAAe,CAAA,SAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAd,CAAA,EAAAe,CAAA,UAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAf,CAAA,CAAAe,CAAA,YAAAN,CAAA,CAAAP,OAAA,GAAAF,CAAA,EAAAM,CAAA,IAAAA,CAAA,CAAAa,GAAA,CAAAnB,CAAA,EAAAS,CAAA,GAAAA,CAAA;AAAA,SAAAW,SAAA,WAAAA,QAAA,GAAAR,MAAA,CAAAS,MAAA,GAAAT,MAAA,CAAAS,MAAA,CAAAC,IAAA,eAAAb,CAAA,aAAAT,CAAA,MAAAA,CAAA,GAAAuB,SAAA,CAAAC,MAAA,EAAAxB,CAAA,UAAAM,CAAA,GAAAiB,SAAA,CAAAvB,CAAA,YAAAK,CAAA,IAAAC,CAAA,OAAAU,cAAA,CAAAC,IAAA,CAAAX,CAAA,EAAAD,CAAA,MAAAI,CAAA,CAAAJ,CAAA,IAAAC,CAAA,CAAAD,CAAA,aAAAI,CAAA,KAAAW,QAAA,CAAAK,KAAA,OAAAF,SAAA,KApBpC;AAsBA,MAAMG,WAAW,GAAG,IAAAC,mCAAsB,EAAC,gBAAgB,CAAC;AAE5D,MAAMC,KAAK,GAAGC,qBAAQ,CAACC,EAAE,KAAK,KAAK;AAEnC,MAAMC,yBAA4D,GAChEC,KAAK,IACF;EACH,MAAM;IACJC,SAAS,GAAGA,CAAA,KAAM,CAAC,CAAC;IACpBC,SAAS,GAAGA,CAAA,KAAM,CAAC,CAAC;IACpBC,aAAa;IACbC,WAAW,GAAG;EAChB,CAAC,GAAGJ,KAAK;EAET,MAAMK,aAAa,GAAG;IACpBC,KAAK,EAAEC,mCAAoB;IAC3BC,MAAM,EAAEC;EACV,CAAC;EACD,MAAMC,YAAuB,GAAGV,KAAK,CAACW,KAAK,GAAGX,KAAK,CAACW,KAAK,GAAGN,aAAa;EACzE,MAAMO,SAAS,GAAGT,aAAa;EAE/B,MAAMU,mBAAmB,GAAIC,QAAa,IAAK;IAC7C,MAAMC,cAAc,GAAG,IAAAC,+BAAsB,EAACF,QAAQ,CAAC;IACvD,IAAIZ,SAAS,EAAE;MACbA,SAAS,CAACa,cAAc,CAAC;IAC3B;EACF,CAAC;EAED,MAAME,mBAAmB,GAAIH,QAAa,IAAK;IAC7C,MAAMC,cAAc,GAAG,IAAAC,+BAAsB,EAACF,QAAQ,CAAC;IACvD,IAAIb,SAAS,EAAE;MACbA,SAAS,CAACc,cAAc,CAAC;IAC3B;EACF,CAAC;EAED,MAAMG,cAAc,GAAIC,MAAW,IACjCC,sBAAS,CAACC,0BAA0B,CAClCF,MAAM;EACN;EACA;EACAC,sBAAS,CAACE,cAAc,CAACC,QAAQ,CAACC,MAAM,CAACC,QAAQ,CAAC,CAAC,EACnD,CAACN,MAAM,CACT,CAAC;EACH,MAAMO,GAAG,GAAG,IAAAC,aAAM,EAAC,IAAI,CAAC;EAExB,MAAMC,cAAc,GAAG,IAAAC,0BAAiB,EAAC7B,KAAK,CAAC4B,cAAc,CAAC;EAE9D,MAAME,WAAW,GAAGA,CAAA,KAAM;IACxB,MAAMX,MAAM,GAAG,IAAAY,2BAAc,EAACL,GAAG,CAACM,OAAO,CAAC;IAC1Cd,cAAc,CAACC,MAAM,CAAC;IACtB,CAACvB,KAAK,IACJqC,kCAAyB,CAACC,qBAAqB,CAC7C/B,aAAa,EACbyB,cAAc,EACdxB,WAAW,EACXS,mBAAmB,EACnBI,mBACF,CAAC;EACL,CAAC;EAGD,MAAMkB,YAAY,GAAG;IACnBxB,KAAK,EAAE;MACL;MACAH,MAAM,EAAE4B,uBAAU,CAACC,yBAAyB,CAAC3B,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEF,MAAM,CAAC;MAClE;MACAF,KAAK,EAAE8B,uBAAU,CAACC,yBAAyB,CAAC3B,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEJ,KAAK;IACjE;EACF,CAAC;EAED,MAAMgC,oBAAoB,GAAG;IAC3B,GAAGtC,KAAK;IACR,GAAGmC;EACL,CAAC;EAED,MAAMI,gBAAgB,GAAG;IACvB,GAAGvC,KAAK;IACR4B,cAAc;IACd1B,SAAS,EAAEW,mBAAmB;IAC9BZ,SAAS,EAAEgB;EACb,CAAC;EAED,IAAAuB,gBAAS,EAAC,MAAM;IACd,CAAC5C,KAAK,IAAIgB,SAAS,IAAI6B,UAAU,CAAC,MAAMX,WAAW,CAAC,CAAC,EAAE,GAAG,CAAC;EAC7D,CAAC,EAAE,EAAE,CAAC;EAEN;IAAA;IACE;IACArE,KAAA,CAAAiF,aAAA,CAAChF,YAAA,CAAAiF,UAAU;MACThC,KAAK,EAAED,YAAa;MACpBkC,aAAa,EAAE,KAAM;MACrBC,4BAA4B,EAAE;IAAM,GAEnCjC,SAAS,gBACRnD,KAAA,CAAAiF,aAAA,CAAChD,WAAW,EAAAN,QAAA,KACLQ,KAAK,GAAG2C,gBAAgB,GAAGD,oBAAoB;MACpDZ,GAAG,EAAEA;IAAI,EACV,CAAC;IAAA;IAEF;IACAjE,KAAA,CAAAiF,aAAA,CAAChF,YAAA,CAAAoF,IAAI,QAAC,wBAA4B,CAE1B;EAAC;AAEjB,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAA9E,OAAA,GAEa6B,yBAAyB","ignoreList":[]}