{"version":3,"names":["ViewManager","requireNativeComponent","DirectPayManager","props","onFailure","onSuccess","requestObject","environment","DEFAULT_STYLE","width","DIRECT_PAY_VIEW_WIDTH","height","DIRECT_PAY_VIEW_HEIGHT","defaultStyle","style","propsDone","isIOS","Platform","OS","createFragment","viewId","UIManager","dispatchViewManagerCommand","DirectPay","Commands","create","toString","returnSuccessParsed","response","responseObject","nativeResponseSelector","returnFailureParsed","ref","useRef","payButtonProps","payButtonSelector","setUpScreen","findNodeHandle","current","RnAmazonPaymentServiceSdk","callDirectPayFortRequest","styleAndroid","PixelRatio","getPixelSizeForLayoutSize","propsAdjustedAndroid","propsAdjustedIOS","useEffect","setTimeout"],"sources":["DirectPayManager.tsx"],"sourcesContent":["import * as React from 'react';\nimport {\n  findNodeHandle,\n  PixelRatio,\n  Platform,\n  requireNativeComponent,\n  ScrollView,\n  UIManager,\n  Text,\n} from 'react-native';\nimport { useEffect, useRef } from 'react';\nimport RnAmazonPaymentServiceSdk from '../nativeModules/RnAmazonPaymentServiceSdk';\nimport nativeResponseSelector from '../utils/nativeResponseSelector';\nimport type { customCheckoutViewProps } from '../types/viewProps';\nimport payButtonSelector from '../utils/payButtonSelector';\nimport {\n  DIRECT_PAY_VIEW_HEIGHT,\n  DIRECT_PAY_VIEW_WIDTH,\n} from '../constants/styleDefaults';\n\nconst ViewManager = requireNativeComponent('DirectPay');\n\nconst DirectPayManager: React.FC<customCheckoutViewProps> = (props) => {\n  const {\n    onFailure = () => {},\n    onSuccess = () => {},\n    requestObject,\n    environment = 'TEST',\n  } = props;\n\n  const DEFAULT_STYLE = {\n    width: DIRECT_PAY_VIEW_WIDTH,\n    height: DIRECT_PAY_VIEW_HEIGHT,\n  };\n  const defaultStyle = props.style ? props.style : DEFAULT_STYLE;\n  const propsDone = requestObject;\n  const isIOS = Platform.OS === 'ios';\n\n  const createFragment = (viewId: any) =>\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // we are calling the 'create' command\n      // @ts-ignore\n      UIManager.DirectPay.Commands.create.toString(),\n      [viewId]\n    );\n\n  const returnSuccessParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onSuccess) {\n      onSuccess(responseObject);\n    }\n  };\n\n  const returnFailureParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onFailure) {\n      onFailure(responseObject);\n    }\n  };\n\n  const ref = useRef(null);\n\n  const payButtonProps = payButtonSelector(props.payButtonProps);\n\n  const setUpScreen = () => {\n    const viewId = findNodeHandle(ref.current);\n    createFragment(viewId);\n    RnAmazonPaymentServiceSdk.callDirectPayFortRequest(\n      requestObject,\n      payButtonProps,\n      environment,\n      returnSuccessParsed,\n      returnFailureParsed\n    );\n  };\n\n  const styleAndroid = {\n    style: {\n      // @ts-ignore\n      height: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.height),\n      // @ts-ignore\n      width: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.width),\n    },\n  };\n\n  const propsAdjustedAndroid = {\n    ...props,\n    ...styleAndroid,\n  };\n\n  const propsAdjustedIOS = {\n    ...props,\n    payButtonProps,\n    onSuccess: returnSuccessParsed,\n    onFailure: returnFailureParsed,\n  };\n\n  useEffect(() => {\n    !isIOS && propsDone && setTimeout(() => setUpScreen(), 200);\n  }, [propsDone]);\n\n  return (\n    // @ts-ignore\n    <ScrollView\n      style={defaultStyle}\n      scrollEnabled={false}\n      showsVerticalScrollIndicator={false}\n    >\n      {propsDone ? (\n        <ViewManager\n          {...(isIOS ? propsAdjustedIOS : propsAdjustedAndroid)}\n          ref={ref}\n        />\n      ) : (\n        // @ts-ignore\n        <Text>Request object missing</Text>\n      )}\n    </ScrollView>\n  );\n};\n\nexport default DirectPayManager;\n"],"mappings":"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"}