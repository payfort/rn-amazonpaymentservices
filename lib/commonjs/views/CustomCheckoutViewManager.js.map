{"version":3,"names":["ViewManager","requireNativeComponent","isIOS","Platform","OS","CustomCheckoutViewManager","props","onFailure","onSuccess","requestObject","environment","DEFAULT_STYLE","width","CUSTOM_UI_VIEW_WIDTH","height","CUSTOM_UI_VIEW_HEIGHT","defaultStyle","style","propsDone","returnSuccessParsed","response","responseObject","nativeResponseSelector","returnFailureParsed","createFragment","viewId","UIManager","dispatchViewManagerCommand","CustomCheckout","Commands","create","toString","ref","useRef","payButtonProps","payButtonSelector","setUpScreen","findNodeHandle","current","RnAmazonPaymentServiceSdk","callCustomFortRequest","styleAndroid","PixelRatio","getPixelSizeForLayoutSize","propsAdjustedAndroid","propsAdjustedIOS","useEffect","setTimeout"],"sources":["CustomCheckoutViewManager.tsx"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport * as React from 'react';\nimport {\n  findNodeHandle,\n  PixelRatio,\n  Platform,\n  requireNativeComponent,\n  Text,\n  ScrollView,\n  UIManager,\n  ViewStyle,\n} from 'react-native';\nimport { useEffect, useRef } from 'react';\nimport RnAmazonPaymentServiceSdk from '../nativeModules/RnAmazonPaymentServiceSdk';\nimport nativeResponseSelector from '../utils/nativeResponseSelector';\nimport type { customCheckoutViewProps } from '../types/viewProps';\nimport payButtonSelector from '../utils/payButtonSelector';\nimport {\n  CUSTOM_UI_VIEW_HEIGHT,\n  CUSTOM_UI_VIEW_WIDTH,\n} from '../constants/styleDefaults';\n\nconst ViewManager = requireNativeComponent('CustomCheckout');\n\nconst isIOS = Platform.OS === 'ios';\n\nconst CustomCheckoutViewManager: React.FC<customCheckoutViewProps> = (\n  props\n) => {\n  const {\n    onFailure = () => {},\n    onSuccess = () => {},\n    requestObject,\n    environment = 'TEST',\n  } = props;\n\n  const DEFAULT_STYLE = {\n    width: CUSTOM_UI_VIEW_WIDTH,\n    height: CUSTOM_UI_VIEW_HEIGHT,\n  };\n  const defaultStyle: ViewStyle = props.style ? props.style : DEFAULT_STYLE;\n  const propsDone = requestObject;\n\n  const returnSuccessParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onSuccess) {\n      onSuccess(responseObject);\n    }\n  };\n\n  const returnFailureParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onFailure) {\n      onFailure(responseObject);\n    }\n  };\n\n  const createFragment = (viewId: any) =>\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // we are calling the 'create' command\n      // @ts-ignore\n      UIManager.CustomCheckout.Commands.create.toString(),\n      [viewId]\n    );\n  const ref = useRef(null);\n\n  const payButtonProps = payButtonSelector(props.payButtonProps);\n\n  const setUpScreen = () => {\n    const viewId = findNodeHandle(ref.current);\n    createFragment(viewId);\n    !isIOS &&\n      RnAmazonPaymentServiceSdk.callCustomFortRequest(\n        requestObject,\n        payButtonProps,\n        environment,\n        returnSuccessParsed,\n        returnFailureParsed\n      );\n  };\n\n\n  const styleAndroid = {\n    style: {\n      // @ts-ignore\n      height: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.height),\n      // @ts-ignore\n      width: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.width),\n    },\n  };\n\n  const propsAdjustedAndroid = {\n    ...props,\n    ...styleAndroid,\n  };\n\n  const propsAdjustedIOS = {\n    ...props,\n    payButtonProps,\n    onSuccess: returnSuccessParsed,\n    onFailure: returnFailureParsed,\n  };\n\n  useEffect(() => {\n    !isIOS && propsDone && setTimeout(() => setUpScreen(), 200);\n  }, []);\n\n  return (\n    // @ts-ignore\n    <ScrollView\n      style={defaultStyle}\n      scrollEnabled={false}\n      showsVerticalScrollIndicator={false}\n    >\n      {propsDone ? (\n        <ViewManager\n          {...(isIOS ? propsAdjustedIOS : propsAdjustedAndroid)}\n          ref={ref}\n        />\n      ) : (\n        // @ts-ignore\n        <Text>Request object missing</Text>\n      )}\n    </ScrollView>\n  );\n};\n\nexport default CustomCheckoutViewManager;\n"],"mappings":"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"}