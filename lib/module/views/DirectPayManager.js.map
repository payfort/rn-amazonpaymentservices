{"version":3,"names":["React","findNodeHandle","PixelRatio","Platform","requireNativeComponent","ScrollView","UIManager","Text","useEffect","useRef","RnAmazonPaymentServiceSdk","nativeResponseSelector","payButtonSelector","DIRECT_PAY_VIEW_HEIGHT","DIRECT_PAY_VIEW_WIDTH","ViewManager","DirectPayManager","props","onFailure","onSuccess","requestObject","environment","DEFAULT_STYLE","width","height","defaultStyle","style","propsDone","isIOS","OS","createFragment","viewId","dispatchViewManagerCommand","DirectPay","Commands","create","toString","returnSuccessParsed","response","responseObject","returnFailureParsed","ref","payButtonProps","setUpScreen","current","callDirectPayFortRequest","styleAndroid","getPixelSizeForLayoutSize","propsAdjustedAndroid","propsAdjustedIOS","setTimeout","createElement","scrollEnabled","showsVerticalScrollIndicator","_extends"],"sources":["DirectPayManager.tsx"],"sourcesContent":["import * as React from 'react';\nimport {\n  findNodeHandle,\n  PixelRatio,\n  Platform,\n  requireNativeComponent,\n  ScrollView,\n  UIManager,\n  Text,\n} from 'react-native';\nimport { useEffect, useRef } from 'react';\nimport RnAmazonPaymentServiceSdk from '../nativeModules/RnAmazonPaymentServiceSdk';\nimport nativeResponseSelector from '../utils/nativeResponseSelector';\nimport type { customCheckoutViewProps } from '../types/viewProps';\nimport payButtonSelector from '../utils/payButtonSelector';\nimport {\n  DIRECT_PAY_VIEW_HEIGHT,\n  DIRECT_PAY_VIEW_WIDTH,\n} from '../constants/styleDefaults';\n\nconst ViewManager = requireNativeComponent('DirectPay');\n\nconst DirectPayManager: React.FC<customCheckoutViewProps> = (props) => {\n  const {\n    onFailure = () => {},\n    onSuccess = () => {},\n    requestObject,\n    environment = 'TEST',\n  } = props;\n\n  const DEFAULT_STYLE = {\n    width: DIRECT_PAY_VIEW_WIDTH,\n    height: DIRECT_PAY_VIEW_HEIGHT,\n  };\n  const defaultStyle = props.style ? props.style : DEFAULT_STYLE;\n  const propsDone = requestObject;\n  const isIOS = Platform.OS === 'ios';\n\n  const createFragment = (viewId: any) =>\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // we are calling the 'create' command\n      // @ts-ignore\n      UIManager.DirectPay.Commands.create.toString(),\n      [viewId]\n    );\n\n  const returnSuccessParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onSuccess) {\n      onSuccess(responseObject);\n    }\n  };\n\n  const returnFailureParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onFailure) {\n      onFailure(responseObject);\n    }\n  };\n\n  const ref = useRef(null);\n\n  const payButtonProps = payButtonSelector(props.payButtonProps);\n\n  const setUpScreen = () => {\n    const viewId = findNodeHandle(ref.current);\n    createFragment(viewId);\n    RnAmazonPaymentServiceSdk.callDirectPayFortRequest(\n      requestObject,\n      payButtonProps,\n      environment,\n      returnSuccessParsed,\n      returnFailureParsed\n    );\n  };\n\n  const styleAndroid = {\n    style: {\n      // @ts-ignore\n      height: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.height),\n      // @ts-ignore\n      width: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.width),\n    },\n  };\n\n  const propsAdjustedAndroid = {\n    ...props,\n    ...styleAndroid,\n  };\n\n  const propsAdjustedIOS = {\n    ...props,\n    payButtonProps,\n    onSuccess: returnSuccessParsed,\n    onFailure: returnFailureParsed,\n  };\n\n  useEffect(() => {\n    !isIOS && propsDone && setTimeout(() => setUpScreen(), 200);\n  }, [propsDone]);\n\n  return (\n    // @ts-ignore\n    <ScrollView\n      style={defaultStyle}\n      scrollEnabled={false}\n      showsVerticalScrollIndicator={false}\n    >\n      {propsDone ? (\n        <ViewManager\n          {...(isIOS ? propsAdjustedIOS : propsAdjustedAndroid)}\n          ref={ref}\n        />\n      ) : (\n        // @ts-ignore\n        <Text>Request object missing</Text>\n      )}\n    </ScrollView>\n  );\n};\n\nexport default DirectPayManager;\n"],"mappings":"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","ignoreList":[]}