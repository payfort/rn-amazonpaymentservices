{"version":3,"names":["React","findNodeHandle","PixelRatio","Platform","requireNativeComponent","Text","ScrollView","UIManager","useEffect","useRef","RnAmazonPaymentServiceSdk","nativeResponseSelector","payButtonSelector","CUSTOM_UI_VIEW_HEIGHT","CUSTOM_UI_VIEW_WIDTH","ViewManager","isIOS","OS","CustomCheckoutViewManager","props","onFailure","onSuccess","requestObject","environment","DEFAULT_STYLE","width","height","defaultStyle","style","propsDone","returnSuccessParsed","response","responseObject","returnFailureParsed","createFragment","viewId","dispatchViewManagerCommand","CustomCheckout","Commands","create","toString","ref","payButtonProps","setUpScreen","current","callCustomFortRequest","styleAndroid","getPixelSizeForLayoutSize","propsAdjustedAndroid","propsAdjustedIOS","setTimeout","createElement","scrollEnabled","showsVerticalScrollIndicator","_extends"],"sources":["CustomCheckoutViewManager.tsx"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport * as React from 'react';\nimport {\n  findNodeHandle,\n  PixelRatio,\n  Platform,\n  requireNativeComponent,\n  Text,\n  ScrollView,\n  UIManager,\n  ViewStyle,\n} from 'react-native';\nimport { useEffect, useRef } from 'react';\nimport RnAmazonPaymentServiceSdk from '../nativeModules/RnAmazonPaymentServiceSdk';\nimport nativeResponseSelector from '../utils/nativeResponseSelector';\nimport type { customCheckoutViewProps } from '../types/viewProps';\nimport payButtonSelector from '../utils/payButtonSelector';\nimport {\n  CUSTOM_UI_VIEW_HEIGHT,\n  CUSTOM_UI_VIEW_WIDTH,\n} from '../constants/styleDefaults';\n\nconst ViewManager = requireNativeComponent('CustomCheckout');\n\nconst isIOS = Platform.OS === 'ios';\n\nconst CustomCheckoutViewManager: React.FC<customCheckoutViewProps> = (\n  props\n) => {\n  const {\n    onFailure = () => {},\n    onSuccess = () => {},\n    requestObject,\n    environment = 'TEST',\n  } = props;\n\n  const DEFAULT_STYLE = {\n    width: CUSTOM_UI_VIEW_WIDTH,\n    height: CUSTOM_UI_VIEW_HEIGHT,\n  };\n  const defaultStyle: ViewStyle = props.style ? props.style : DEFAULT_STYLE;\n  const propsDone = requestObject;\n\n  const returnSuccessParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onSuccess) {\n      onSuccess(responseObject);\n    }\n  };\n\n  const returnFailureParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onFailure) {\n      onFailure(responseObject);\n    }\n  };\n\n  const createFragment = (viewId: any) =>\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // we are calling the 'create' command\n      // @ts-ignore\n      UIManager.CustomCheckout.Commands.create.toString(),\n      [viewId]\n    );\n  const ref = useRef(null);\n\n  const payButtonProps = payButtonSelector(props.payButtonProps);\n\n  const setUpScreen = () => {\n    const viewId = findNodeHandle(ref.current);\n    createFragment(viewId);\n    !isIOS &&\n      RnAmazonPaymentServiceSdk.callCustomFortRequest(\n        requestObject,\n        payButtonProps,\n        environment,\n        returnSuccessParsed,\n        returnFailureParsed\n      );\n  };\n\n\n  const styleAndroid = {\n    style: {\n      // @ts-ignore\n      height: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.height),\n      // @ts-ignore\n      width: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.width),\n    },\n  };\n\n  const propsAdjustedAndroid = {\n    ...props,\n    ...styleAndroid,\n  };\n\n  const propsAdjustedIOS = {\n    ...props,\n    payButtonProps,\n    onSuccess: returnSuccessParsed,\n    onFailure: returnFailureParsed,\n  };\n\n  useEffect(() => {\n    !isIOS && propsDone && setTimeout(() => setUpScreen(), 200);\n  }, []);\n\n  return (\n    // @ts-ignore\n    <ScrollView\n      style={defaultStyle}\n      scrollEnabled={false}\n      showsVerticalScrollIndicator={false}\n    >\n      {propsDone ? (\n        <ViewManager\n          {...(isIOS ? propsAdjustedIOS : propsAdjustedAndroid)}\n          ref={ref}\n        />\n      ) : (\n        // @ts-ignore\n        <Text>Request object missing</Text>\n      )}\n    </ScrollView>\n  );\n};\n\nexport default CustomCheckoutViewManager;\n"],"mappings":"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","ignoreList":[]}