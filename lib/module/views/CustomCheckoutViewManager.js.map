{"version":3,"names":["React","findNodeHandle","PixelRatio","Platform","requireNativeComponent","Text","ScrollView","UIManager","useEffect","useRef","RnAmazonPaymentServiceSdk","nativeResponseSelector","payButtonSelector","CUSTOM_UI_VIEW_HEIGHT","CUSTOM_UI_VIEW_WIDTH","ViewManager","isIOS","OS","CustomCheckoutViewManager","props","onFailure","onSuccess","requestObject","environment","DEFAULT_STYLE","width","height","defaultStyle","style","propsDone","returnSuccessParsed","response","responseObject","returnFailureParsed","createFragment","viewId","dispatchViewManagerCommand","CustomCheckout","Commands","create","toString","ref","payButtonProps","setUpScreen","current","callCustomFortRequest","styleAndroid","getPixelSizeForLayoutSize","propsAdjustedAndroid","propsAdjustedIOS","setTimeout"],"sources":["CustomCheckoutViewManager.tsx"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport * as React from 'react';\nimport {\n  findNodeHandle,\n  PixelRatio,\n  Platform,\n  requireNativeComponent,\n  Text,\n  ScrollView,\n  UIManager,\n  ViewStyle,\n} from 'react-native';\nimport { useEffect, useRef } from 'react';\nimport RnAmazonPaymentServiceSdk from '../nativeModules/RnAmazonPaymentServiceSdk';\nimport nativeResponseSelector from '../utils/nativeResponseSelector';\nimport type { customCheckoutViewProps } from '../types/viewProps';\nimport payButtonSelector from '../utils/payButtonSelector';\nimport {\n  CUSTOM_UI_VIEW_HEIGHT,\n  CUSTOM_UI_VIEW_WIDTH,\n} from '../constants/styleDefaults';\n\nconst ViewManager = requireNativeComponent('CustomCheckout');\n\nconst isIOS = Platform.OS === 'ios';\n\nconst CustomCheckoutViewManager: React.FC<customCheckoutViewProps> = (\n  props\n) => {\n  const {\n    onFailure = () => {},\n    onSuccess = () => {},\n    requestObject,\n    environment = 'TEST',\n  } = props;\n\n  const DEFAULT_STYLE = {\n    width: CUSTOM_UI_VIEW_WIDTH,\n    height: CUSTOM_UI_VIEW_HEIGHT,\n  };\n  const defaultStyle: ViewStyle = props.style ? props.style : DEFAULT_STYLE;\n  const propsDone = requestObject;\n\n  const returnSuccessParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onSuccess) {\n      onSuccess(responseObject);\n    }\n  };\n\n  const returnFailureParsed = (response: any) => {\n    const responseObject = nativeResponseSelector(response);\n    if (onFailure) {\n      onFailure(responseObject);\n    }\n  };\n\n  const createFragment = (viewId: any) =>\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // we are calling the 'create' command\n      // @ts-ignore\n      UIManager.CustomCheckout.Commands.create.toString(),\n      [viewId]\n    );\n  const ref = useRef(null);\n\n  const payButtonProps = payButtonSelector(props.payButtonProps);\n\n  const setUpScreen = () => {\n    const viewId = findNodeHandle(ref.current);\n    createFragment(viewId);\n    !isIOS &&\n      RnAmazonPaymentServiceSdk.callCustomFortRequest(\n        requestObject,\n        payButtonProps,\n        environment,\n        returnSuccessParsed,\n        returnFailureParsed\n      );\n  };\n\n\n  const styleAndroid = {\n    style: {\n      // @ts-ignore\n      height: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.height),\n      // @ts-ignore\n      width: PixelRatio.getPixelSizeForLayoutSize(defaultStyle?.width),\n    },\n  };\n\n  const propsAdjustedAndroid = {\n    ...props,\n    ...styleAndroid,\n  };\n\n  const propsAdjustedIOS = {\n    ...props,\n    payButtonProps,\n    onSuccess: returnSuccessParsed,\n    onFailure: returnFailureParsed,\n  };\n\n  useEffect(() => {\n    !isIOS && propsDone && setTimeout(() => setUpScreen(), 200);\n  }, []);\n\n  return (\n    // @ts-ignore\n    <ScrollView\n      style={defaultStyle}\n      scrollEnabled={false}\n      showsVerticalScrollIndicator={false}\n    >\n      {propsDone ? (\n        <ViewManager\n          {...(isIOS ? propsAdjustedIOS : propsAdjustedAndroid)}\n          ref={ref}\n        />\n      ) : (\n        // @ts-ignore\n        <Text>Request object missing</Text>\n      )}\n    </ScrollView>\n  );\n};\n\nexport default CustomCheckoutViewManager;\n"],"mappings":"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"}